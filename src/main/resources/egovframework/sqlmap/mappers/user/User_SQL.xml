<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
  @Class Name  : User_SQL.xml
  @Description : 회원 관련 SQL 구문 (회원가입 및 ID 중복검사)

  @Modification Information
           수정일                        수정자          수정내용
     2025.10.14       노유경          최초 생성 (회원가입 및 ID 중복검사 쿼리 작성)
     2025.10.14       노유경          컬럼명(DB)과 VO 속성명 매핑 수정 (USER_ID, USER_NAME 등 대문자 통일)
     2025.10.15       노유경          resultMap 추가 및 VO 매핑 구조 명확화 (UserVO 필드 일치 검증)
     2025.10.15       노유경          insertUser 구문에 useGeneratedKeys, keyProperty 적용 (자동 증가 PK 매핑)
     2025.10.15       노유경          regDt 컬럼 LocalDate 대응을 위해 VO 매핑 점검 및 now() 기본값 유지
-->

<!-- 매퍼를 구분하는 식별자 User -->
<mapper namespace="User">

	<!-- 컬럼과 필드면 매핑 -->
	<resultMap id="userVO" type="com.lime.user.vo.UserVO">
		<result property="userSeq" column="USER_SEQ" />
		<result property="userId" column="USER_ID" />
		<result property="pwd" column="PWD" />
		<result property="userName" column="USER_NAME" />
		<result property="regDt" column="REG_DT"/>
	</resultMap>

	<!-- ID 중복 검사 -->
	<select id="checkId" parameterType="string" resultType="int">
		select 
			count(*)
		from 
			USER_TB
		where 
			USER_ID = #{value}
	</select>

	<!-- 회원 등록 -->
	<insert id="insertUser" parameterType="com.lime.user.vo.UserVO" useGeneratedKeys="true" keyProperty="userSeq">
		insert 
			into 
				USER_TB
				(
				USER_ID, 
				PWD, 
				USER_NAME, 
				REG_DT
				) 
		values 
				(
				#{userId}, 
				#{pwd}, 
				#{userName}, 
				CURRENT_DATE
				)

	</insert>

</mapper>