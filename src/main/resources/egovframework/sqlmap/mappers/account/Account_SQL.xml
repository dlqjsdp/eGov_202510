<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 
@File Name      : Account_SQL.xml
@Class Name     : Account_SQL
@Description    : 회계(Account) 관련 SQL 매퍼 파일
@Modification Information
       
         수정일                  수정자         수정내용
    2025.10.20    노유경        ACCOUNT_TB 데이터 등록(INSERT) 쿼리 추가
    2025.10.21    노유경        등록 시 생성된 계정번호(accountSeq)가 자동으로 저장되도록 수정
    2025.10.22    노유경        단건 조회(selectAccountDetail) 및 데이터 수정(updateAccount) 쿼리 추가
    2025.10.23    노유경        selectAccountDetail의 파라미터 바인딩을 #{accountSeq} → #{value}로 수정
    2025.10.26    노유경        회계정보 목록 조회(selectAccountList) 및 총건수(selectAccountListCount) 쿼리 추가
       
@since 2025.10.20
@version 1.2
-->

<mapper namespace="Account">
	
	<!-- 데이터 등록하기 -->
	<insert id="insertAccount" parameterType="egovMap" useGeneratedKeys="true" keyProperty="accountSeq">
		insert 
			into 
				ACCOUNT_TB 
				(
				PROFIT_COST, 
				BIG_GROUP, 
				MIDDLE_GROUP, 
				SMALL_GROUP, 
				DETAIL_GROUP,
				COMMENTS, 
				TRANSACTION_MONEY, 
				TRANSACTION_DATE, 
				WRITER, 
				REG_DATE
				)
		values 
				(
				#{profitCost}, 
				#{bigGroup}, 
				#{middleGroup}, 
				#{smallGroup}, 
				#{detailGroup},
    			#{comments}, 
    			#{transactionMoney}, 
    			#{transactionDate}, 
    			#{writer}, 
    			NOW()
				)			
	</insert>
	
	
	<!-- 데이터 단건조회 -->
	<select id="selectAccountDetail" parameterType="long" resultType="egovMap">
		SELECT 
			ACCOUNT_SEQ, 
		   	PROFIT_COST,
		   	BIG_GROUP,
		   	MIDDLE_GROUP,
		   	SMALL_GROUP, 
		   	DETAIL_GROUP,
		   	COMMENTS,
		   	TRANSACTION_MONEY,
		   	TRANSACTION_DATE,
		   	WRITER 
		FROM 
			ACCOUNT_TB 
		WHERE 
			ACCOUNT_SEQ = #{value}
	</select>
	
	
	<!-- 데이터 수정하기 -->
	<update id="updateAccount" parameterType="egovMap">
	  	UPDATE 
	  		ACCOUNT_TB 
	 	SET 
	 		PROFIT_COST = #{profitCost},
		  	BIG_GROUP = #{bigGroup},
		  	MIDDLE_GROUP = #{middleGroup}, 
		  	SMALL_GROUP = #{smallGroup},
		  	DETAIL_GROUP = #{detailGroup},
		  	COMMENTS = #{comments},
		  	TRANSACTION_MONEY = #{transactionMoney},
		  	TRANSACTION_DATE = #{transactionDate}
	  	WHERE 
	  		ACCOUNT_SEQ = #{accountSeq}
	</update>
	
	
	<!-- 회계정보 목록 조회 -->
	<select id="selectAccountList" parameterType="egovMap" resultType="egovMap">
		  SELECT
		    ACCOUNT_SEQ,
		    PROFIT_COST_NM,
		    BIG_GROUP_NM,
		    MIDDLE_GROUP_NM,
		    SMALL_GROUP_NM,
		    DETAIL_GROUP_NM,
		    COMMENTS,
		    TRANSACTION_MONEY,
		    TRANSACTION_DATE,
		    WRITER_NM,
		    REG_DATE
		  FROM 
		  	vw_account_tb
		  ORDER BY 
		  	ACCOUNT_SEQ DESC
		  LIMIT #{recordCountPerPage} OFFSET #{firstIndex}
	</select>

	
	<!-- 회계정보 총 건수 (페이징용) -->
	<select id="selectAccountListCount" parameterType="egovMap" resultType="int">
	  SELECT 
	  	COUNT(*)
	  FROM 
	  	vw_account_tb
	</select>
	
</mapper>